<div class="profile-page">
  <main class="page-content">
    <section class="hero">
      <div class="hero-text">
        <h1>Управляйте профилем в едином рабочем пространстве</h1>
        <p class="hero-lead">
          Обновляйте отображаемое имя, чтобы коллеги видели актуальные данные в расшифровках и комментариях. Все
          изменения синхронизируются моментально.
        </p>
        <ul class="hero-highlights">
          <li>Единый профиль для всех сервисов YouScriptor</li>
          <li>Автоматическое обновление данных в задачах по расшифровке</li>
          <li>Защищённое хранение и обработка персональной информации</li>
        </ul>
        <div class="hero-actions">
          <a class="btn btn-primary" [routerLink]="['/transcriptions']">
            <mat-icon>arrow_back</mat-icon>
            <span>К расшифровкам</span>
          </a>
          <button class="btn btn-secondary" type="button" (click)="fetchProfile()" [disabled]="loading">
            <mat-icon>refresh</mat-icon>
            <span>Обновить данные</span>
          </button>
        </div>
      </div>
      <div class="hero-card">
        <div class="card-header">Текущее отображаемое имя</div>
        <div class="card-value">{{ displayNameValue || '—' }}</div>
        <div class="card-description">
          Оно используется в расшифровках, комментариях и уведомлениях команды. Изменяйте его, если хотите поменять,
          как вас видят коллеги.
        </div>
        <div class="card-footnote">Последнее обновление подтянется автоматически после сохранения.</div>
      </div>
    </section>

    <section class="profile-settings">
      <div class="section-header">
        <h2>Настройки профиля</h2>
        <p>
          Введите отображаемое имя — оно появится в списке задач и в совместной работе над документами. Максимальная
          длина имени — 100 символов.
        </p>
      </div>

      <div class="settings-grid">
        <div class="settings-card">
          <div class="state" *ngIf="loading">
            <mat-progress-spinner mode="indeterminate" diameter="48"></mat-progress-spinner>
            <span>Загружаем профиль…</span>
          </div>

          <div class="state state-error" *ngIf="loadError && !loading">
            <mat-icon>error_outline</mat-icon>
            <span>{{ loadError }}</span>
          </div>

          <form class="settings-form" *ngIf="!loading && !loadError" [formGroup]="form" (ngSubmit)="submit()">
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Отображаемое имя</mat-label>
              <input matInput formControlName="displayName" maxlength="100" />
              <mat-error *ngIf="form.controls.displayName.hasError('required')">
                Введите отображаемое имя.
              </mat-error>
              <mat-hint align="end">Максимум 100 символов.</mat-hint>
            </mat-form-field>

            <div class="actions">
              <div class="status-messages">
                <span class="error" *ngIf="saveError">{{ saveError }}</span>
                <span class="success" *ngIf="saveSuccess && !saveError">Изменения сохранены.</span>
              </div>
              <button class="btn btn-primary" type="submit" [disabled]="saving">
                <mat-icon *ngIf="saving">hourglass_top</mat-icon>
                <span>{{ saving ? 'Сохранение…' : 'Сохранить изменения' }}</span>
              </button>
            </div>
          </form>
        </div>

        <div class="tips-card">
          <h3>Советы по оформлению</h3>
          <ul>
            <li>Используйте реальное имя или псевдоним, который узнают коллеги.</li>
            <li>Не добавляйте контактные данные — для них есть профиль организации.</li>
            <li>Обновляйте имя перед публикацией расшифровок или отчётов.</li>
          </ul>
        </div>
      </div>
    </section>
  </main>
</div>
